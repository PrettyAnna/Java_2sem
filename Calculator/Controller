package ui;

import javafx.animation.KeyFrame;
import javafx.animation.KeyValue;
import javafx.animation.Timeline;
import javafx.event.ActionEvent;
import javafx.fxml.FXML;
import javafx.geometry.Insets;
import javafx.scene.control.Button;
import javafx.scene.control.TextField;
import javafx.scene.layout.Background;
import javafx.scene.layout.BackgroundFill;
import javafx.scene.layout.CornerRadii;
import javafx.scene.paint.Paint;
import javafx.util.Duration;

public class Controller {
    @FXML
    private TextField expression;
    private Evaluator evaluator;

    public Controller() {
    }

    public void setEvaluator(Evaluator e) {
        this.evaluator = e;
    }

    @FXML
    private void clickBack(ActionEvent e) {
        this.expression.setText(this.expression.getText().length() > 0 ? this.expression.getText().substring(0, this.expression.getText().length() - 1) : "");
    }

    @FXML
    private void clickSymbol(ActionEvent e) {
        this.expression.setText(this.expression.getText() + ((Button)e.getSource()).getText());
    }

    @FXML
    private void clear(ActionEvent e) {
        this.expression.setText("");
    }

    @FXML
    private void evaluate(ActionEvent e) {
        try {
            this.expression.setText(Double.toString(this.evaluator.evaluate(this.expression.getText())));
        } catch (NumberFormatException var6) {
            Background bg = this.expression.getBackground();
            Background bgerr = new Background(new BackgroundFill(Paint.valueOf("ff7777"), CornerRadii.EMPTY, Insets.EMPTY));
            Timeline timeline = new Timeline(new KeyFrame(Duration.seconds(0.0D), (event) -> {
                this.expression.setBackground(bgerr);
            }), new KeyFrame(Duration.seconds(0.5D), (event) -> {
                this.expression.setBackground(bg);
            }));
            timeline.setCycleCount(1);
            timeline.play();
        }

        this.expression.positionCaret(this.expression.getText().length());
    }
}
